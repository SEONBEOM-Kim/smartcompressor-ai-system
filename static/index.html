<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signalcraft: AI ëƒ‰ë™ê³  ì§„ë‹¨ ì„œë¹„ìŠ¤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
        }
        .feature-card {
            transition: transform 0.3s ease;
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }
        .section-padding {
            padding: 80px 0;
        }
        .text-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#home">
                <i class="fas fa-shield-alt me-2"></i>Signalcraft
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">í™ˆ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#features">ê¸°ëŠ¥</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#pricing">ìš”ê¸ˆì œ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#demo">ì²´í—˜</a>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-outline-light ms-2" onclick="showLoginModal()">ë¡œê·¸ì¸</button>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-warning ms-2" onclick="kakaoLogin()">
                            <i class="fab fa-kickstarter me-1"></i>ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-light ms-2" onclick="showRegisterModal()">íšŒì›ê°€ì…</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- ë©”ì¸ íˆì–´ë¡œ ì„¹ì…˜ -->
    <section id="home" class="hero-section">
            <div class="container">
            <div class="row align-items-center">
                    <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">
                        ì‚¬ì¥ë‹˜ì´ ì ë“  ì‚¬ì´,<br>
                        <span class="text-gradient">ì•„ì´ìŠ¤í¬ë¦¼ì´ ë…¹ê¸° ì „ì—</span>
</h1>
                    <p class="lead mb-4">
                        AI ê¸°ìˆ ë¡œ ëƒ‰ë™ê³ ë¥¼ 24ì‹œê°„ ëª¨ë‹ˆí„°ë§í•˜ê³ , ë¬¸ì œë¥¼ ë¯¸ë¦¬ ê°ì§€í•˜ì—¬ 
                        ë§¤ì¥ì„ ì§€ì¼œë“œë¦½ë‹ˆë‹¤. ë” ì´ìƒ ëƒ‰ë™ê³  ê³ ì¥ìœ¼ë¡œ ì¸í•œ ì†ì‹¤ì„ ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”.
                    </p>
                    <div class="d-flex gap-3">
                            <button class="btn btn-primary btn-lg" onclick="showRegisterModal()">
                            <i class="fas fa-rocket me-2"></i>ë¬´ë£Œ ì²´í—˜í•˜ê¸°
                        </button>
                        <button class="btn btn-outline-light btn-lg" onclick="scrollToSection('demo')">
                            <i class="fas fa-play me-2"></i>ë°ëª¨ ë³´ê¸°
                        </button>
                    </div>
                </div>
                <div class="col-lg-6 text-center">
                    <div class="position-relative">
                        <i class="fas fa-thermometer-half" style="font-size: 200px; opacity: 0.8;"></i>
                        <div class="position-absolute top-50 start-50 translate-middle">
                            <i class="fas fa-brain text-warning" style="font-size: 60px;"></i>
                        </div>
                    </div>
                </div>
            </div>
                            </div>
    </section>

    <!-- ê¸°ëŠ¥ ì†Œê°œ ì„¹ì…˜ -->
    <section id="features" class="section-padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center mb-5">
                    <h2 class="display-5 fw-bold mb-3">ì™œ Signalcraftì¸ê°€?</h2>
                    <p class="lead text-muted">
                        ìµœì²¨ë‹¨ AI ê¸°ìˆ ê³¼ ìŒì„± ë¶„ì„ì„ í†µí•´ ëƒ‰ë™ê³ ì˜ ì´ìƒì„ ì •í™•í•˜ê²Œ ê°ì§€í•©ë‹ˆë‹¤.
                    </p>
                            </div>
                            </div>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card feature-card h-100 text-center p-4">
                        <div class="card-body">
                            <i class="fas fa-microphone-alt text-primary mb-3" style="font-size: 3rem;"></i>
                            <h5 class="card-title">ìŒì„± ë¶„ì„</h5>
                            <p class="card-text">
                                ëƒ‰ë™ê³ ì—ì„œ ë‚˜ëŠ” ì†Œë¦¬ë¥¼ AIê°€ ë¶„ì„í•˜ì—¬ ì´ìƒì„ ê°ì§€í•©ë‹ˆë‹¤.
                            </p>
                        </div>
                    </div>
                                    </div>
                <div class="col-md-4">
                    <div class="card feature-card h-100 text-center p-4">
                                    <div class="card-body">
                            <i class="fas fa-clock text-success mb-3" style="font-size: 3rem;"></i>
                            <h5 class="card-title">24ì‹œê°„ ëª¨ë‹ˆí„°ë§</h5>
                            <p class="card-text">
                                ì–¸ì œë“ ì§€ ëƒ‰ë™ê³  ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                            </p>
                        </div>
                    </div>
                                                    </div>
                <div class="col-md-4">
                    <div class="card feature-card h-100 text-center p-4">
                        <div class="card-body">
                            <i class="fas fa-bell text-warning mb-3" style="font-size: 3rem;"></i>
                            <h5 class="card-title">ì¦‰ì‹œ ì•Œë¦¼</h5>
                            <p class="card-text">
                                ë¬¸ì œê°€ ê°ì§€ë˜ë©´ ì¦‰ì‹œ ì•Œë¦¼ì„ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.
                            </p>
                                                </div>
                                            </div>
                                                </div>
                                            </div>
                                        </div>
    </section>

    <!-- ìš”ê¸ˆì œ ì„¹ì…˜ -->
    <section id="pricing" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="display-5 fw-bold">ìš”ê¸ˆì œ</h2>
                <p class="lead text-muted">ë§¤ì¥ ê·œëª¨ì— ë§ëŠ” ìµœì ì˜ ì„ íƒì„ í•˜ì„¸ìš”</p>
            </div>
            <div class="row g-4 justify-content-center">
                <!-- ì—ì„¼ì…œ í”Œëœ -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm pricing-card">
                        <div class="card-body text-center p-4">
                            <h5 class="card-title">ì—ì„¼ì…œ</h5>
                            <div class="price-display">
                                <span class="price-amount">29,000</span>
                                <span class="price-unit">ì›/ì›”</span>
                            </div>
                            <ul class="list-unstyled mt-4">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>í•µì‹¬ ëƒ‰ë™ê³  3ëŒ€</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ê³ ì¥ ì§•í›„ ì•Œë¦¼ (ê²½ë³´ê¸°)</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ì´ë©”ì¼ & ì±—ë´‡ ì§€ì›</li>
                            </ul>
                            <button class="btn btn-outline-primary w-100 mt-3" onclick="selectPlan('essential')">
                                ì„ íƒí•˜ê¸°
                            </button>
                                        </div>
                                    </div>
                                </div>

                <!-- ìŠ¤íƒ ë‹¤ë“œ í”Œëœ (ê°€ì¥ ì¸ê¸°) -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm pricing-card border-primary position-relative">
                        <div class="badge bg-primary position-absolute top-0 start-50 translate-middle px-3 py-2">
                            ê°€ì¥ ì¸ê¸°
                        </div>
                        <div class="card-body text-center p-4">
                            <h5 class="card-title">ìŠ¤íƒ ë‹¤ë“œ</h5>
                            <div class="price-display">
                                <span class="price-amount">59,000</span>
                                <span class="price-unit">ì›/ì›”</span>
                            </div>
                            <ul class="list-unstyled mt-4">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ëƒ‰ë™ê³  10ëŒ€ê¹Œì§€</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>AI ì§„ë‹¨ ë¦¬í¬íŠ¸</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ì „í™” & ì´ë©”ì¼ ì§€ì›</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ìš°ì„  ê¸°ìˆ ì§€ì›</li>
                            </ul>
                            <button class="btn btn-primary w-100 mt-3" onclick="selectPlan('standard')">
                                ì„ íƒí•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>

                <!-- í”„ë¦¬ë¯¸ì—„ í”Œëœ -->
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm pricing-card">
                        <div class="card-body text-center p-4">
                            <h5 class="card-title">í”„ë¦¬ë¯¸ì—„</h5>
                            <div class="price-display">
                                <span class="price-amount">99,000</span>
                                <span class="price-unit">ì›/ì›”</span>
                            </div>
                            <ul class="list-unstyled mt-4">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ë¬´ì œí•œ ëƒ‰ë™ê³ </li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>24/7 ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ê³ ê¸‰ AI ë¶„ì„</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ì „ë‹´ ë§¤ë‹ˆì €</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ê¸´ê¸‰ ì¶œë™ ì„œë¹„ìŠ¤</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ë§ì¶¤í˜• ë¦¬í¬íŠ¸</li>
                            </ul>
                            <button class="btn btn-outline-primary w-100 mt-3" onclick="selectPlan('premium')">
                                ì„ íƒí•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
        </div>
    </div>
</section>

    <!-- AI ì§„ë‹¨ ì²´í—˜ ì„¹ì…˜ -->
    <section id="demo" class="section-padding bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto text-center">
                    <h2 class="display-5 fw-bold mb-3">AI ì••ì¶•ê¸° ì§„ë‹¨ ì²´í—˜</h2>
                    <p class="lead text-muted mb-4">
                        ì‹¤ì œ ëƒ‰ë™ê³  ì†Œë¦¬ë¥¼ ë…¹ìŒí•˜ì—¬ ê³ ì„±ëŠ¥ ì•™ìƒë¸” AIê°€ ì§„ë‹¨í•´ë“œë¦½ë‹ˆë‹¤
                    </p>
                    
                    <!-- AI ëª¨ë¸ ì •ë³´ -->
                    <div class="row mb-5">
                        <div class="col-md-3 mb-3">
                            <div class="card h-100 border-0 bg-white shadow-sm">
                                <div class="card-body text-center">
                                    <i class="fas fa-brain text-primary fa-2x mb-2"></i>
                                    <h6 class="card-title">MIMII ëª¨ë¸</h6>
                                    <small class="text-muted">40% ê°€ì¤‘ì¹˜<br>ê³ ì„±ëŠ¥ ì´ìƒ ê°ì§€</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card h-100 border-0 bg-white shadow-sm">
                                <div class="card-body text-center">
                                    <i class="fas fa-tree text-success fa-2x mb-2"></i>
                                    <h6 class="card-title">RandomForest</h6>
                                    <small class="text-muted">25% ê°€ì¤‘ì¹˜<br>íŠ¹ì„± ì¤‘ìš”ë„ ê¸°ë°˜</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card h-100 border-0 bg-white shadow-sm">
                                <div class="card-body text-center">
                                    <i class="fas fa-chart-line text-warning fa-2x mb-2"></i>
                                    <h6 class="card-title">SVM</h6>
                                    <small class="text-muted">15% ê°€ì¤‘ì¹˜<br>ê³ ì°¨ì› íŠ¹ì„± ì²˜ë¦¬</small>
                                </div>
                            </div>
                </div>
                        <div class="col-md-3 mb-3">
                            <div class="card h-100 border-0 bg-white shadow-sm">
                                <div class="card-body text-center">
                                    <i class="fas fa-network-wired text-info fa-2x mb-2"></i>
                                    <h6 class="card-title">MLP + LR</h6>
                                    <small class="text-muted">20% ê°€ì¤‘ì¹˜<br>ì‹ ê²½ë§ + ì„ í˜•ë¶„ë¥˜</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì‹¤ì œ AI ì§„ë‹¨ ì¸í„°í˜ì´ìŠ¤ -->
                    <div class="ai-diagnosis-section" style="margin: 30px 0; padding: 30px; background: #ffffff; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 class="mb-4">ì‹¤ì‹œê°„ AI ì§„ë‹¨</h3>
                        <p class="text-muted mb-4">ë§ˆì´í¬ë¡œ ì••ì¶•ê¸° ì†ŒìŒì„ ë…¹ìŒí•˜ì—¬ ê³¼ë¶€í•˜ìŒì„ ì‹¤ì‹œê°„ìœ¼ë¡œ íŒë³„í•©ë‹ˆë‹¤</p>
                        
                        <div class="diagnosis-controls text-center mb-4">
                            <button id="recordBtn" class="btn btn-primary btn-lg me-3">ğŸ¤ ë…¹ìŒ ì‹œì‘</button>
                            <button id="analyzeBtn" class="btn btn-success btn-lg me-3" disabled>ğŸ” ì§„ë‹¨í•˜ê¸°</button>
                            <button id="reportBtn" class="btn btn-info btn-lg" disabled style="display: none;">ğŸ“Š ìƒì„¸ ë¦¬í¬íŠ¸ ë³´ê¸°</button>
                        </div>
                        
                        <div id="diagnosisStatus" class="alert alert-info text-center" style="display: none;"></div>
                        <div id="diagnosisResult" class="result-card" style="display: none;"></div>
                    </div>
                    
                    <!-- ì²´í—˜ ë²„íŠ¼ë“¤ -->
                        <div class="d-flex gap-3 justify-content-center flex-wrap mt-4">
                            <a href="/static/audio_recorder_client.html" class="btn btn-outline-primary btn-lg">
                                <i class="fas fa-external-link-alt me-2"></i>ì „ì²´ ê¸°ëŠ¥ ì²´í—˜í•˜ê¸°
                            </a>
                            <button class="btn btn-primary btn-lg" onclick="showRegisterModal()">
                                <i class="fas fa-user-plus me-2"></i>ë¬´ë£Œ íšŒì›ê°€ì…
                            </button>
                            <button class="btn btn-warning btn-lg" onclick="kakaoLogin()">
                                <i class="fab fa-kickstarter me-2"></i>ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸
                            </button>
                        </div>
                    
                    <!-- íŠ¹ì§• ì„¤ëª… -->
                    <div class="row mt-5">
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-microphone-alt text-primary fa-2x me-3"></i>
                                <div>
                                    <h6 class="mb-1">ì‹¤ì‹œê°„ ë…¹ìŒ</h6>
                                    <small class="text-muted">ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ ë…¹ìŒ</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-cogs text-success fa-2x me-3"></i>
                                <div>
                                    <h6 class="mb-1">200+ íŠ¹ì„± ì¶”ì¶œ</h6>
                                    <small class="text-muted">ê³ ê¸‰ ì˜¤ë””ì˜¤ ë¶„ì„</small>
                            </div>
                        </div>
                    </div>
                        <div class="col-md-4 mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-chart-bar text-warning fa-2x me-3"></i>
                                <div>
                                    <h6 class="mb-1">ì•™ìƒë¸” AI</h6>
                                    <small class="text-muted">5ê°œ ëª¨ë¸ í†µí•© ë¶„ì„</small>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    <!-- í‘¸í„° -->
    <footer class="bg-dark text-light py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Signalcraft</h5>
                    <p class="text-muted">
                        AI ê¸°ìˆ ë¡œ ëƒ‰ë™ê³  ì§„ë‹¨ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ë§¤ì¥ì„ ì§€ì¼œë“œë¦½ë‹ˆë‹¤
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted">
                        ë¬¸ì˜: <strong>010-8533-6898</strong> | <strong>sndercer@gmail.com</strong><br>
                        Â© 2024 Signalcraft. All rights reserved.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/app.js"></script>
    <script>
        // ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({
                behavior: 'smooth'
            });
        }

        // ìš”ê¸ˆì œ ì„ íƒ í•¨ìˆ˜
        function selectPlan(planType) {
            console.log('ì„ íƒëœ í”Œëœ:', planType);
            // íšŒì›ê°€ì… ëª¨ë‹¬ í‘œì‹œ
            showRegisterModal();
        }

        // ë„¤ë¹„ê²Œì´ì…˜ ë§í¬ í´ë¦­ ì‹œ ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>

    <!-- AI ì§„ë‹¨ ê¸°ëŠ¥ JavaScript -->
<script>
        // AI ì§„ë‹¨ ê¸°ëŠ¥ í´ë˜ìŠ¤
class IntegratedAIDiagnosis {
    constructor() {
        this.isRecording = false;
        this.mediaRecorder = null;
        this.audioChunks = [];
        this.audioBlob = null;
        this.diagnosisResult = null;
        this.init();
    }

    init() {
        this.recordBtn = document.getElementById('recordBtn');
        this.analyzeBtn = document.getElementById('analyzeBtn');
        this.reportBtn = document.getElementById('reportBtn');
        this.status = document.getElementById('diagnosisStatus');
        this.result = document.getElementById('diagnosisResult');

                if (this.recordBtn) {
        this.recordBtn.addEventListener('click', () => this.toggleRecording());
                }
                if (this.analyzeBtn) {
        this.analyzeBtn.addEventListener('click', () => this.analyzeAudio());
                }
                if (this.reportBtn) {
        this.reportBtn.addEventListener('click', () => this.showDetailedReport());
                }

        this.checkBrowserSupport();
    }

    checkBrowserSupport() {
        const hasGetUserMedia = !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);
        const hasMediaRecorder = typeof MediaRecorder !== 'undefined';
        
        if (!hasGetUserMedia || !hasMediaRecorder) {
            this.showStatus('âŒ ì´ ë¸Œë¼ìš°ì €ëŠ” ë…¹ìŒ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìµœì‹  Chrome, Firefox, Safarië¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.', 'danger');
                    if (this.recordBtn) this.recordBtn.disabled = true;
            return false;
        }

        if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
            this.showStatus('âš ï¸ ë…¹ìŒ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ HTTPS ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ëŠ” ì œí•œëœ ê¸°ëŠ¥ë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'warning');
        }

        return true;
    }

    async toggleRecording() {
        if (!this.isRecording) {
            await this.startRecording();
        } else {
            this.stopRecording();
        }
    }

    async startRecording() {
        try {
            const constraints = {
                audio: {
                    echoCancellation: true,
                    noiseSuppression: true,
                    sampleRate: 16000
                }
            };

            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            this.mediaRecorder = new MediaRecorder(stream, {
                mimeType: 'audio/webm;codecs=opus'
            });

                    this.audioChunks = [];
            this.mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    this.audioChunks.push(event.data);
                }
            };

            this.mediaRecorder.onstop = () => {
                this.audioBlob = new Blob(this.audioChunks, { type: 'audio/webm' });
                this.analyzeBtn.disabled = false;
                this.showStatus('âœ… ë…¹ìŒ ì™„ë£Œ! ì§„ë‹¨í•˜ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.', 'success');
            };

            this.mediaRecorder.start();
            this.isRecording = true;
            this.recordBtn.textContent = 'â¹ï¸ ë…¹ìŒ ì¤‘ì§€';
                    this.recordBtn.className = 'btn btn-danger btn-lg me-3';
                    this.analyzeBtn.disabled = true;
            this.hideResult();

                    this.showStatus('ğŸ¤ ë…¹ìŒ ì¤‘... (5-10ì´ˆê°„ ë…¹ìŒí•˜ì„¸ìš”)', 'info');

        } catch (error) {
            console.error('ë…¹ìŒ ì˜¤ë¥˜:', error);
                this.showStatus('âŒ ë…¹ìŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'danger');
        }
    }

    stopRecording() {
        if (this.mediaRecorder && this.isRecording) {
            this.mediaRecorder.stop();
            this.isRecording = false;
            this.recordBtn.textContent = 'ğŸ¤ ë…¹ìŒ ì‹œì‘';
                    this.recordBtn.className = 'btn btn-primary btn-lg me-3';
        }
    }

    async analyzeAudio() {
        if (!this.audioBlob) {
                    this.showStatus('âŒ ë¨¼ì € ë…¹ìŒì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.', 'danger');
            return;
        }

                this.showStatus('ğŸ” AIê°€ ì˜¤ë””ì˜¤ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...', 'info');
        this.analyzeBtn.disabled = true;

        try {
            const formData = new FormData();
                    formData.append('audio', this.audioBlob);
            formData.append('timestamp', new Date().toISOString());

                    const response = await fetch('/api/lightweight-analyze', {
                        method: 'POST',
                        body: formData
                    });

            const data = await response.json();
                this.diagnosisResult = data;
                this.showResult(data);
                this.reportBtn.style.display = 'inline-block';

        } catch (error) {
            console.error('ë¶„ì„ ì˜¤ë¥˜:', error);
                    this.showStatus('âŒ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'danger');
                } finally {
        this.analyzeBtn.disabled = false;
                }
    }

    showResult(data) {
                const resultClass = data.is_overload ? 'overload' : 'normal';
        this.result.innerHTML = `
                    <div class="result-card ${resultClass}">
                        <h3>${data.is_overload ? 'âš ï¸ ê³¼ë¶€í•˜ìŒ ê°ì§€' : 'âœ… ì •ìƒ ì‘ë™'}</h3>
                        <p>ì‹ ë¢°ë„: ${Math.round(data.confidence * 100)}%</p>
                        <p>ì²˜ë¦¬ ì‹œê°„: ${data.processing_time_ms.toFixed(1)}ms</p>
                        <p>${data.message}</p>
            </div>
        `;
                this.result.style.display = 'block';
    }

    showDetailedReport() {
        if (this.diagnosisResult) {
            sessionStorage.setItem('diagnosisResult', JSON.stringify(this.diagnosisResult));
            window.location.href = '/diagnosis-report';
        }
    }

    showStatus(message, type) {
                if (this.status) {
        this.status.textContent = message;
        this.status.className = `alert alert-${type} text-center`;
        this.status.style.display = 'block';
                }
    }

    hideResult() {
                if (this.result) {
        this.result.style.display = 'none';
                }
                if (this.reportBtn) {
        this.reportBtn.style.display = 'none';
                }
    }
}

        // í˜ì´ì§€ ë¡œë“œ ì‹œ AI ì§„ë‹¨ ê¸°ëŠ¥ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', () => {
    new IntegratedAIDiagnosis();
});
</script>

<style>
.result-card.overload {
    background-color: #ffebee;
    border-left: 4px solid #f44336;
}

.result-card.normal {
    background-color: #e8f5e8;
    border-left: 4px solid #4caf50;
}

.ai-diagnosis-section {
    border: 1px solid #dee2e6;
}
</style>
</body>
</html>