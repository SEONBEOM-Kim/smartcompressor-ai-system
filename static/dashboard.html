<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드 - Signalcraft</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-container {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        
        .status-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-normal { background-color: #28a745; }
        .status-warning { background-color: #ffc107; }
        .status-danger { background-color: #dc3545; }
        
        .metric-card {
            text-align: center;
            padding: 20px;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .metric-label {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .alert-item {
            border-left: 4px solid #dc3545;
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
        }
        
        .alert-warning {
            border-left-color: #ffc107;
        }
        
        .alert-info {
            border-left-color: #17a2b8;
        }
        
        .recent-diagnosis {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .diagnosis-item {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }
        
        .diagnosis-item:last-child {
            border-bottom: none;
        }
        
        .badge-status {
            font-size: 0.8rem;
            padding: 5px 10px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="container-fluid">
            <!-- 헤더 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <h1 class="h3 mb-0">
                            <i class="fas fa-tachometer-alt me-2"></i>압축기 대시보드
                        </h1>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary btn-sm" onclick="refreshDashboard()">
                                <i class="fas fa-sync-alt me-1"></i>새로고침
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="showSettings()">
                                <i class="fas fa-cog me-1"></i>설정
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 상태 카드들 -->
            <div class="row mb-4">
                <!-- 현재 상태 -->
                <div class="col-lg-3 col-md-6 mb-3">
                    <div class="status-card">
                        <div class="d-flex align-items-center mb-3">
                            <i class="fas fa-thermometer-half text-primary me-2"></i>
                            <h5 class="mb-0">현재 상태</h5>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <span class="status-indicator status-normal" id="statusIndicator"></span>
                            <span class="fw-bold" id="statusText">정상 작동</span>
                        </div>
                        <small class="text-muted" id="lastCheck">마지막 확인: 2분 전</small>
                    </div>
                </div>

                <!-- 온도 -->
                <div class="col-lg-3 col-md-6 mb-3">
                    <div class="status-card">
                        <div class="d-flex align-items-center mb-3">
                            <i class="fas fa-thermometer-half text-info me-2"></i>
                            <h5 class="mb-0">온도</h5>
                        </div>
                        <div class="metric-value text-info" id="temperatureValue">-18°C</div>
                        <div class="metric-label">냉동고 내부</div>
                    </div>
                </div>

                <!-- 압력 -->
                <div class="col-lg-3 col-md-6 mb-3">
                    <div class="status-card">
                        <div class="d-flex align-items-center mb-3">
                            <i class="fas fa-tachometer-alt text-success me-2"></i>
                            <h5 class="mb-0">압력</h5>
                        </div>
                        <div class="metric-value text-success" id="pressureValue">2.5 bar</div>
                        <div class="metric-label">압축기 압력</div>
                    </div>
                </div>

                <!-- 진동 -->
                <div class="col-lg-3 col-md-6 mb-3">
                    <div class="status-card">
                        <div class="d-flex align-items-center mb-3">
                            <i class="fas fa-wave-square text-warning me-2"></i>
                            <h5 class="mb-0">진동</h5>
                        </div>
                        <div class="metric-value text-warning" id="vibrationValue">0.3 mm/s</div>
                        <div class="metric-label">진동 레벨</div>
                    </div>
                </div>
            </div>

            <!-- 메인 콘텐츠 -->
            <div class="row">
                <!-- 왼쪽 컬럼 -->
                <div class="col-lg-8">
                    <!-- 실시간 모니터링 차트 -->
                    <div class="status-card">
                        <h5 class="mb-3">
                            <i class="fas fa-chart-line me-2"></i>실시간 모니터링
                        </h5>
                        <div class="chart-container">
                            <canvas id="monitoringChart"></canvas>
                        </div>
                    </div>

                    <!-- 최근 진단 결과 -->
                    <div class="status-card">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="fas fa-stethoscope me-2"></i>최근 진단 결과
                            </h5>
                            <a href="#diagnosis" class="btn btn-sm btn-outline-primary">전체 보기</a>
                        </div>
                        <div class="recent-diagnosis" id="recentDiagnosis">
                            <!-- JavaScript로 동적 생성 -->
                        </div>
                    </div>
                </div>

                <!-- 오른쪽 컬럼 -->
                <div class="col-lg-4">
                    <!-- 알림 센터 -->
                    <div class="status-card">
                        <h5 class="mb-3">
                            <i class="fas fa-bell me-2"></i>알림 센터
                        </h5>
                        <div id="alertCenter">
                            <!-- JavaScript로 동적 생성 -->
                        </div>
                    </div>

                    <!-- 진단 통계 -->
                    <div class="status-card">
                        <h5 class="mb-3">
                            <i class="fas fa-chart-pie me-2"></i>진단 통계
                        </h5>
                        <div class="row text-center">
                            <div class="col-6 mb-3">
                                <div class="metric-value text-primary" id="todayDiagnosis">5</div>
                                <div class="metric-label">오늘 진단</div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="metric-value text-success" id="weekDiagnosis">32</div>
                                <div class="metric-label">이번 주</div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="metric-value text-info" id="successRate">98.5%</div>
                                <div class="metric-label">성공률</div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="metric-value text-warning" id="avgResponse">1.2s</div>
                                <div class="metric-label">평균 응답</div>
                            </div>
                        </div>
                    </div>

                    <!-- 빠른 설정 -->
                    <div class="status-card">
                        <h5 class="mb-3">
                            <i class="fas fa-cog me-2"></i>빠른 설정
                        </h5>
                        <div class="mb-3">
                            <label class="form-label">알림 임계값</label>
                            <select class="form-select form-select-sm" id="alertThreshold">
                                <option value="0.7">높음 (70%)</option>
                                <option value="0.5" selected>보통 (50%)</option>
                                <option value="0.3">낮음 (30%)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">체크 간격</label>
                            <select class="form-select form-select-sm" id="checkInterval">
                                <option value="30">30초</option>
                                <option value="60" selected>1분</option>
                                <option value="300">5분</option>
                            </select>
                        </div>
                        <button class="btn btn-primary btn-sm w-100" onclick="saveSettings()">
                            <i class="fas fa-save me-1"></i>설정 저장
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 설정 모달 -->
    <div class="modal fade" id="settingsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">설정</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">알림 설정</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="emailAlerts" checked>
                            <label class="form-check-label" for="emailAlerts">이메일 알림</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="smsAlerts">
                            <label class="form-check-label" for="smsAlerts">SMS 알림</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="kakaoAlerts" checked>
                            <label class="form-check-label" for="kakaoAlerts">카카오톡 알림</label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="saveSettings()">저장</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/dashboard.js"></script>
</body>
</html>
