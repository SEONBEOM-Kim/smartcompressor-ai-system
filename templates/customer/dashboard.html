<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signalcraft 대시보드</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link href="/static/css/dashboard.css" rel="stylesheet">
</head>
<body>
    <!-- 네비게이션 바 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-snowflake me-2"></i>
                Signalcraft
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#overview">
                            <i class="fas fa-tachometer-alt me-1"></i>개요
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#stores">
                            <i class="fas fa-store me-1"></i>매장
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#devices">
                            <i class="fas fa-microchip me-1"></i>디바이스
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#analytics">
                            <i class="fas fa-chart-line me-1"></i>분석
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#notifications">
                            <i class="fas fa-bell me-1"></i>알림
                        </a>
                    </li>
                </ul>
                
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>
                            <span id="userName">관리자</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#profile"><i class="fas fa-user me-2"></i>프로필</a></li>
                            <li><a class="dropdown-item" href="#settings"><i class="fas fa-cog me-2"></i>설정</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#logout"><i class="fas fa-sign-out-alt me-2"></i>로그아웃</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 메인 컨텐츠 -->
    <div class="container-fluid mt-5 pt-3">
        <!-- 개요 섹션 -->
        <div id="overview" class="dashboard-section">
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="mb-3">
                        <i class="fas fa-tachometer-alt me-2"></i>시스템 개요
                    </h2>
                </div>
            </div>
            
            <!-- 주요 지표 카드 -->
            <div class="row mb-4">
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-primary shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                        총 매장 수
                                    </div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalStores">-</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-store fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-success shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                        온라인 디바이스
                                    </div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="onlineDevices">-</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-microchip fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-warning shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                        경고 알림
                                    </div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="warningAlerts">-</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-exclamation-triangle fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-info shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                        에너지 비용
                                    </div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="energyCost">-</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-bolt fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 차트 영역 -->
            <div class="row mb-4">
                <div class="col-xl-8 col-lg-7">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                            <h6 class="m-0 font-weight-bold text-primary">에너지 소비량 추이</h6>
                            <div class="dropdown no-arrow">
                                <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown">
                                    <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right shadow">
                                    <a class="dropdown-item" href="#" onclick="updateChart('7d')">최근 7일</a>
                                    <a class="dropdown-item" href="#" onclick="updateChart('30d')">최근 30일</a>
                                    <a class="dropdown-item" href="#" onclick="updateChart('90d')">최근 90일</a>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-area">
                                <canvas id="energyChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-4 col-lg-5">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                            <h6 class="m-0 font-weight-bold text-primary">디바이스 상태</h6>
                        </div>
                        <div class="card-body">
                            <div class="chart-pie pt-4 pb-2">
                                <canvas id="deviceStatusChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 매장 섹션 -->
        <div id="stores" class="dashboard-section" style="display: none;">
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="mb-3">
                        <i class="fas fa-store me-2"></i>매장 관리
                    </h2>
                </div>
            </div>
            
            <!-- 매장 목록 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">매장 목록</h6>
                    <button class="btn btn-primary btn-sm" onclick="showAddStoreModal()">
                        <i class="fas fa-plus me-1"></i>매장 추가
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="storesTable">
                            <thead>
                                <tr>
                                    <th>매장명</th>
                                    <th>주소</th>
                                    <th>상태</th>
                                    <th>디바이스 수</th>
                                    <th>가동률</th>
                                    <th>마지막 활동</th>
                                    <th>작업</th>
                                </tr>
                            </thead>
                            <tbody id="storesTableBody">
                                <!-- 동적으로 로드됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 디바이스 섹션 -->
        <div id="devices" class="dashboard-section" style="display: none;">
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="mb-3">
                        <i class="fas fa-microchip me-2"></i>디바이스 관리
                    </h2>
                </div>
            </div>
            
            <!-- 디바이스 목록 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">디바이스 목록</h6>
                    <button class="btn btn-primary btn-sm" onclick="showAddDeviceModal()">
                        <i class="fas fa-plus me-1"></i>디바이스 추가
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="devicesTable">
                            <thead>
                                <tr>
                                    <th>디바이스명</th>
                                    <th>매장</th>
                                    <th>타입</th>
                                    <th>상태</th>
                                    <th>건강도</th>
                                    <th>마지막 점검</th>
                                    <th>작업</th>
                                </tr>
                            </thead>
                            <tbody id="devicesTableBody">
                                <!-- 동적으로 로드됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 분석 섹션 -->
        <div id="analytics" class="dashboard-section" style="display: none;">
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="mb-3">
                        <i class="fas fa-chart-line me-2"></i>데이터 분석
                    </h2>
                </div>
            </div>
            
            <!-- 분석 차트들 -->
            <div class="row mb-4">
                <div class="col-xl-6 col-lg-6">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">온도 트렌드</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="temperatureChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-6 col-lg-6">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">진동 분석</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="vibrationChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-xl-6 col-lg-6">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">전력 소비 패턴</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="powerChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="col-xl-6 col-lg-6">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">이상 감지 패턴</h6>
                        </div>
                        <div class="card-body">
                            <canvas id="anomalyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 알림 섹션 -->
        <div id="notifications" class="dashboard-section" style="display: none;">
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="mb-3">
                        <i class="fas fa-bell me-2"></i>알림 관리
                    </h2>
                </div>
            </div>
            
            <!-- 알림 설정 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">알림 설정</h6>
                </div>
                <div class="card-body">
                    <form id="notificationSettingsForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">이메일 알림</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="emailEnabled" checked>
                                        <label class="form-check-label" for="emailEnabled">
                                            이메일 알림 받기
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">SMS 알림</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="smsEnabled" checked>
                                        <label class="form-check-label" for="smsEnabled">
                                            SMS 알림 받기
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">조용한 시간</label>
                                    <div class="row">
                                        <div class="col-6">
                                            <input type="time" class="form-control" id="quietStart" value="22:00">
                                        </div>
                                        <div class="col-6">
                                            <input type="time" class="form-control" id="quietEnd" value="08:00">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">최대 알림 수 (시간당)</label>
                                    <input type="number" class="form-control" id="maxNotifications" value="10" min="1" max="100">
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">설정 저장</button>
                    </form>
                </div>
            </div>
            
            <!-- 알림 이력 -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">알림 이력</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="notificationsTable">
                            <thead>
                                <tr>
                                    <th>시간</th>
                                    <th>유형</th>
                                    <th>매장</th>
                                    <th>메시지</th>
                                    <th>상태</th>
                                </tr>
                            </thead>
                            <tbody id="notificationsTableBody">
                                <!-- 동적으로 로드됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 매장 추가 모달 -->
    <div class="modal fade" id="addStoreModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">매장 추가</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addStoreForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">매장명 *</label>
                                    <input type="text" class="form-control" id="storeName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">매장 유형</label>
                                    <select class="form-control" id="storeType">
                                        <option value="franchise">프랜차이즈</option>
                                        <option value="corporate">직영</option>
                                        <option value="partner">파트너</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label class="form-label">주소 *</label>
                            <input type="text" class="form-control" id="storeAddress" required>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group mb-3">
                                    <label class="form-label">도시 *</label>
                                    <input type="text" class="form-control" id="storeCity" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group mb-3">
                                    <label class="form-label">시/도 *</label>
                                    <input type="text" class="form-control" id="storeState" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group mb-3">
                                    <label class="form-label">우편번호 *</label>
                                    <input type="text" class="form-control" id="storeZipCode" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">전화번호 *</label>
                                    <input type="tel" class="form-control" id="storePhone" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">이메일 *</label>
                                    <input type="email" class="form-control" id="storeEmail" required>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="addStore()">추가</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 디바이스 추가 모달 -->
    <div class="modal fade" id="addDeviceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">디바이스 추가</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addDeviceForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">디바이스명 *</label>
                                    <input type="text" class="form-control" id="deviceName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">매장 *</label>
                                    <select class="form-control" id="deviceStore" required>
                                        <option value="">매장 선택</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">디바이스 타입 *</label>
                                    <select class="form-control" id="deviceType" required>
                                        <option value="compressor">압축기</option>
                                        <option value="sensor">센서</option>
                                        <option value="monitor">모니터</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">모델 *</label>
                                    <input type="text" class="form-control" id="deviceModel" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label class="form-label">시리얼 번호 *</label>
                            <input type="text" class="form-control" id="deviceSerial" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="addDevice()">추가</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Dashboard Modules -->
    <script src="/static/js/dashboard/utils/formatters.js"></script>
    <script src="/static/js/dashboard/utils/helpers.js"></script>
    <script src="/static/js/dashboard/charts/energy-chart.js"></script>
    <script src="/static/js/dashboard/charts/device-status-chart.js"></script>
    <script src="/static/js/dashboard/charts/temperature-chart.js"></script>
    <script src="/static/js/dashboard/charts/vibration-chart.js"></script>
    <script src="/static/js/dashboard/charts/power-chart.js"></script>
    <script src="/static/js/dashboard/charts/anomaly-chart.js"></script>
    <script src="/static/js/dashboard/charts/chart-manager.js"></script>
    <script src="/static/js/dashboard/data/api-client.js"></script>
    <script src="/static/js/dashboard/data/data-loader.js"></script>
    <script src="/static/js/dashboard/ui/table-renderer.js"></script>
    <script src="/static/js/dashboard/ui/section-manager.js"></script>
    <script src="/static/js/dashboard/ui/card-updater.js"></script>
    <script src="/static/js/dashboard/dashboard.js"></script>
</body>
</html>
